<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div class="sm-playlist">
      <div class="sm-playlist-items">
        <header class="sm-playlist-header">
          <p class="sm-playlist-title">A Crumb Coat for the Mind</p>
          <p class="sm-playlist-duration">18 Tracks / 1 hour 17 minutes</p>
          <p class="sm-playlist-description">
            Indie, gaze, bubble music for people who are already numb but
            looking to get number
          </p>
          <a
            class="sm-icon-button"
            href="https://music.youtube.com/playlist?list=PLnPe3mrvTpEzNINsV2kNqY_LTeNkdprdL"
            target="_blank"
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              fill="currentColor"
              class="bi bi-collection-play-fill"
              viewBox="0 0 16 16"
            >
              <path
                d="M2.5 3.5a.5.5 0 0 1 0-1h11a.5.5 0 0 1 0 1h-11zm2-2a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1h-7zM0 13a1.5 1.5 0 0 0 1.5 1.5h13A1.5 1.5 0 0 0 16 13V6a1.5 1.5 0 0 0-1.5-1.5h-13A1.5 1.5 0 0 0 0 6v7zm6.258-6.437a.5.5 0 0 1 .507.013l4 2.5a.5.5 0 0 1 0 .848l-4 2.5A.5.5 0 0 1 6 12V7a.5.5 0 0 1 .258-.437z"
              />
            </svg>
            Play</a
          >
        </header>

        <button class="sm-playlist-item" data-src="OgHyWg7Jh3k" data-idx="0">
          <p class="sm-playlist-item-number">1</p>
          <img
            src="https://i.ytimg.com/vi/OgHyWg7Jh3k/mqdefault.jpg"
            alt="Dune"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Dune</p>
            <p class="sm-playlist-item-artist">Kikagaku Moyo</p>
            <p class="sm-playlist-item-duration">2 minutes 9 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="Gte3m_-jyCw" data-idx="1">
          <p class="sm-playlist-item-number">2</p>
          <img
            src="https://i.ytimg.com/vi/Gte3m_-jyCw/mqdefault.jpg"
            alt="I Won't Be There"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">I Won't Be There</p>
            <p class="sm-playlist-item-artist">Skinshape</p>
            <p class="sm-playlist-item-duration">7 minutes 3 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="6PfYo-YYVPY" data-idx="2">
          <p class="sm-playlist-item-number">3</p>
          <img
            src="https://i.ytimg.com/vi/6PfYo-YYVPY/mqdefault.jpg"
            alt="Staring At The Sun"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Staring At The Sun</p>
            <p class="sm-playlist-item-artist">Wooden Shjips</p>
            <p class="sm-playlist-item-duration">7 minutes 28 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="Esit0k1NE4I" data-idx="3">
          <p class="sm-playlist-item-number">4</p>
          <img
            src="https://i.ytimg.com/vi/Esit0k1NE4I/mqdefault.jpg"
            alt="Snow Days"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Snow Days</p>
            <p class="sm-playlist-item-artist">Real Estate</p>
            <p class="sm-playlist-item-duration">4 minutes 23 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="15m_iQaKHVg" data-idx="4">
          <p class="sm-playlist-item-number">5</p>
          <img
            src="https://i.ytimg.com/vi/15m_iQaKHVg/mqdefault.jpg"
            alt="Spitting Off the Edge of the World"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">
              Spitting Off the Edge of the World
            </p>
            <p class="sm-playlist-item-artist">Yeah Yeah Yeahs</p>
            <p class="sm-playlist-item-duration">4 minutes 18 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="aA5l2qsX_O8" data-idx="5">
          <p class="sm-playlist-item-number">6</p>
          <img
            src="https://i.ytimg.com/vi/aA5l2qsX_O8/mqdefault.jpg"
            alt="Paprika"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Paprika</p>
            <p class="sm-playlist-item-artist">Japanese Breakfast</p>
            <p class="sm-playlist-item-duration">3 minutes 41 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="HdemOVIXuAI" data-idx="6">
          <p class="sm-playlist-item-number">7</p>
          <img
            src="https://i.ytimg.com/vi/HdemOVIXuAI/mqdefault.jpg"
            alt="Dopamine"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Dopamine</p>
            <p class="sm-playlist-item-artist">DIIV</p>
            <p class="sm-playlist-item-duration">3 minutes 56 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="BqnG_Ei35JE" data-idx="7">
          <p class="sm-playlist-item-number">8</p>
          <img
            src="https://i.ytimg.com/vi/BqnG_Ei35JE/mqdefault.jpg"
            alt="Crumb - Locket [Official Video]"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">
              Crumb - Locket [Official Video]
            </p>
            <p class="sm-playlist-item-artist">Crumb The Band</p>
            <p class="sm-playlist-item-duration">5 minutes 19 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="RV1-GJJf2Pg" data-idx="8">
          <p class="sm-playlist-item-number">9</p>
          <img
            src="https://i.ytimg.com/vi/RV1-GJJf2Pg/mqdefault.jpg"
            alt="Not Strong Enough"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Not Strong Enough</p>
            <p class="sm-playlist-item-artist">boygenius</p>
            <p class="sm-playlist-item-duration">3 minutes 55 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="Wmw0ELu_jrM" data-idx="9">
          <p class="sm-playlist-item-number">10</p>
          <img
            src="https://i.ytimg.com/vi/Wmw0ELu_jrM/mqdefault.jpg"
            alt="Wasted Acres"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Wasted Acres</p>
            <p class="sm-playlist-item-artist">Grizzly Bear</p>
            <p class="sm-playlist-item-duration">2 minutes 53 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="jQt6ZzJfioc" data-idx="10">
          <p class="sm-playlist-item-number">11</p>
          <img
            src="https://i.ytimg.com/vi/jQt6ZzJfioc/mqdefault.jpg"
            alt="Mind Fields"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Mind Fields</p>
            <p class="sm-playlist-item-artist">No Vacation</p>
            <p class="sm-playlist-item-duration">4 minutes 33 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="nXITdhX0AsE" data-idx="11">
          <p class="sm-playlist-item-number">12</p>
          <img
            src="https://i.ytimg.com/vi/nXITdhX0AsE/mqdefault.jpg"
            alt="Big Sis"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Big Sis</p>
            <p class="sm-playlist-item-artist">SALES</p>
            <p class="sm-playlist-item-duration">2 minutes 47 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="wSTYIyQxfPQ" data-idx="12">
          <p class="sm-playlist-item-number">13</p>
          <img
            src="https://i.ytimg.com/vi/wSTYIyQxfPQ/mqdefault.jpg"
            alt="Show Me How"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Show Me How</p>
            <p class="sm-playlist-item-artist">Men I Trust</p>
            <p class="sm-playlist-item-duration">3 minutes 36 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="7AEK0psjkZo" data-idx="13">
          <p class="sm-playlist-item-number">14</p>
          <img
            src="https://i.ytimg.com/vi/7AEK0psjkZo/mqdefault.jpg"
            alt="Elbow Pain"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Elbow Pain</p>
            <p class="sm-playlist-item-artist">Glue Trip</p>
            <p class="sm-playlist-item-duration">5 minutes 34 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="4a4zu5t83yY" data-idx="14">
          <p class="sm-playlist-item-number">15</p>
          <img
            src="https://i.ytimg.com/vi/4a4zu5t83yY/mqdefault.jpg"
            alt="Redbone"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Redbone</p>
            <p class="sm-playlist-item-artist">Childish Gambino</p>
            <p class="sm-playlist-item-duration">5 minutes 27 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="5jzXLv_zdH4" data-idx="15">
          <p class="sm-playlist-item-number">16</p>
          <img
            src="https://i.ytimg.com/vi/5jzXLv_zdH4/mqdefault.jpg"
            alt="Idaho Alien"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Idaho Alien</p>
            <p class="sm-playlist-item-artist">Youth Lagoon</p>
            <p class="sm-playlist-item-duration">3 minutes 24 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="1JIvfi0v4ZY" data-idx="16">
          <p class="sm-playlist-item-number">17</p>
          <img
            src="https://i.ytimg.com/vi/1JIvfi0v4ZY/mqdefault.jpg"
            alt="Psychos"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Psychos</p>
            <p class="sm-playlist-item-artist">Jenny Lewis</p>
            <p class="sm-playlist-item-duration">3 minutes 6 seconds</p>
          </div>
        </button>
        <button class="sm-playlist-item" data-src="qWIpelAsycg" data-idx="17">
          <p class="sm-playlist-item-number">18</p>
          <img
            src="https://i.ytimg.com/vi/qWIpelAsycg/mqdefault.jpg"
            alt="Love Again"
          />
          <div class="sm-playlist-item-info">
            <p class="sm-playlist-item-title">Love Again</p>
            <p class="sm-playlist-item-artist">Meltt</p>
            <p class="sm-playlist-item-duration">4 minutes 4 seconds</p>
          </div>
        </button>
      </div>
      <div class="sm-playlist-content" id="player"></div>
    </div>

    <script>
      let nIntervId;
      let currentPlayingSongIndex;
      const playerContainer = document.querySelector('.sm-playlist-content');
      const tag = document.createElement('script');
      tag.src = 'https://www.youtube.com/iframe_api';

      const buttons = document.querySelectorAll('.sm-playlist-item');

      document.head.append(tag);

      function onYouTubeIframeAPIReady() {
        const player = new YT.Player('player', {
          height: '360',
          width: '640',
          playerVars: {
            modestbranding: 1,
            enablejsapi: 1,
            list: 'PLnPe3mrvTpEzNINsV2kNqY_LTeNkdprdL',
            listType: 'playlist',
          },

          events: {
            onReady: onPlayerReady,
            onStateChange: onPlayerStateChange,
          },
        });

        function onPlayerReady() {
          buttons.forEach((button) => {
            button.addEventListener('click', () => {
              currentSong = button.dataset.idx;

              player.playVideoAt(currentSong);
            });
          });
        }

        function showSongProgress() {
          const currentSongIndex = player.getPlaylistIndex();
          currentPlayingSongIndex = currentSongIndex;
          const currentSong = document.querySelector(
            'button[data-idx="' + currentSongIndex + '"]'
          );
          const ratio = player.getCurrentTime() / player.getDuration();
          currentSong.style.background = `linear-gradient(to right, #e74c3c ${
            ratio * 100
          }%, #fff ${ratio * 100}%)`;
        }

        function onPlayerStateChange(event) {
          console.log(event.data);
          if (event.data === 2) {
            console.log('paused');
            clearInterval(nIntervId);
            nIntervId = null;
           
            const currentSong = document.querySelector(
              'button[data-idx="' + currentPlayingSongIndex + '"]'
            );
            currentSong.style.background = 'white';
          } else if (event.data === 1) {
            if (nIntervId) {
              clearInterval(nIntervId);
              nIntervId = null;
            }

            console.log(
              '🚀 ~ file: index.html:304 ~ onPlayerStateChange ~ currentSong:',
              currentSong
            );
            int = setInterval(showSongProgress, 800);
          } else {
            clearInterval(nIntervId);
            nIntervId = null;
          }
        }
      }
    </script>
  </body>
</html>
